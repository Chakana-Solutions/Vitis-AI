<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
<!-- End Google Tag Manager -->
  <title>Quick Start Guide for Versal V70 &mdash; Vitis™ AI 3.5 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Custom Board to Do" href="custom_target.html" />
    <link rel="prev" title="Quick Start Guide for Versal™ AI Edge VEK280" href="vek280.html" /> 
</head>

<body class="wy-body-for-nav">

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
<!-- End Google Tag Manager --> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../index.html" class="icon icon-home"> Vitis™ AI
            <img src="../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Setup and Install</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../reference/release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/system_requirements.html">System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Host Install Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="vek280.html">Quick Start Guide for VEK280</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick Start Guide for V70</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#system-requirements">System Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#applicable-targets">Applicable Targets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#quickstart">Quickstart</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation-procedure">Installation Procedure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#versal-v70-setup">Versal V70 Setup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#clone-the-vitis-ai-repository">Clone the Vitis AI Repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-docker">Install Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pull-vitis-ai-docker">Pull Vitis AI Docker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#docker-container-environment-variable-setup">Docker Container Environment Variable Setup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-the-vitis-ai-examples">Run the Vitis AI Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quantize-compile-deploy-a-model">Quantize, Compile, Deploy a Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#working-with-the-vitis-ai-library">Working with the Vitis AI Library</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="custom_target.html">Quick Start Guide for Custom Targets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Workflow and Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../workflow.html">First Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow.html#supported-evaluation-targets">Supported Evaluation Targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow-system-integration.html">What is a DPU?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow-system-integration.html#vitis-ai-dpu-ip-and-reference-designs">Vitis AI DPU IP and Reference Designs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow-system-integration.html#integrating-the-dpu">Integrating the DPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ref_design_docs/README_DPUCV2DX8G.html">VEK280 DPUCV2DX8G Reference Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow-model-zoo.html">Vitis AI Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow-model-development.html">Developing a Model for Vitis AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow-model-deployment.html">Deploying a Model with Vitis AI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Runtime API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../doxygen/api/classlist.html">Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doxygen/api/filelist.html">File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doxygen/api/namespacelist.html">Namespace</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/release_documentation.html">Vitis AI User Guides &amp; IP Product Guides</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Xilinx/Vitis-AI-Tutorials">Vitis AI Developer Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow-third-party.html">Third-party Inference Stack Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/version_compatibility.html">IP and Tools Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/branching_tagging_strategy.html">Branching and Tagging Strategy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources and Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/additional_resources.html">Technical Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/additional_resources.html#id1">Additional Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Related AMD Solutions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Xilinx/DPU-PYNQ">DPU-PYNQ</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/finn/">FINN &amp; Brevitas</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/inference-server/">Inference Server</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/amd/UIF">Unified Inference Frontend</a></li>
<li class="toctree-l1"><a class="reference external" href="https://onnxruntime.ai/docs/execution-providers/community-maintained/Vitis-AI-ExecutionProvider.html">Vitis AI ONNX Runtime Execution Provider</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/VVAS/">Vitis Video Analytics SDK</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Vitis™ AI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Quick Start Guide for Versal V70</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/docs/quickstart/v70.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="quick-start-guide-for-versal-v70">
<h1>Quick Start Guide for Versal V70<a class="headerlink" href="#quick-start-guide-for-versal-v70" title="Permalink to this heading">¶</a></h1>
<p>The AMD <strong>DPUCV2DX8G</strong> for the Versal™  V70 is a configurable computation engine dedicated to convolutional neural networks. It supports a highly optimized instruction set, enabling the deployment of most convolutional neural networks. The following instructions will help you to install the software and packages required to support V70.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading">¶</a></h2>
<section id="system-requirements">
<h3>System Requirements<a class="headerlink" href="#system-requirements" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Confirm that your development machine meets the minimum <a class="reference internal" href="../reference/system_requirements.html"><span class="doc">Host System Requirements</span></a>.</p></li>
<li><p>Confirm that you have at least <strong>100GB</strong> of free space in the target partition.</p></li>
</ul>
</section>
<section id="applicable-targets">
<h3>Applicable Targets<a class="headerlink" href="#applicable-targets" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>This quickstart is applicable to the <a class="reference external" href="https://www.xilinx.com/applications/data-center/v70.html">V70</a></p></li>
</ul>
</section>
</section>
<section id="quickstart">
<h2>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this heading">¶</a></h2>
<section id="installation-procedure">
<h3>Installation Procedure<a class="headerlink" href="#installation-procedure" title="Permalink to this heading">¶</a></h3>
<section id="versal-v70-setup">
<h4>Versal V70 Setup<a class="headerlink" href="#versal-v70-setup" title="Permalink to this heading">¶</a></h4>
<p>A script is provided to drive the V70 card setup process.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should run this script on the host machine, OUTSIDE of the Docker container. After the script has executed successfully, manually reboot the host server once. For data center DPUs, Vitis AI 3.5 specifically leverages the 2022.2 versions of the Vitis tools, V70 platform, XRT and XRM.</p>
</div>
<p>This script will detect the operating system of the host, and will download and install the appropriate packages for that operating system.</p>
<p>Execute this script as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">&lt;</span><span class="n">Vitis</span><span class="o">-</span><span class="n">AI</span> <span class="n">install</span> <span class="n">path</span><span class="o">&gt;/</span><span class="n">Vitis</span><span class="o">-</span><span class="n">AI</span><span class="o">/</span><span class="n">board_setup</span><span class="o">/</span><span class="n">v70</span>
<span class="n">source</span> <span class="o">./</span><span class="n">install</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>The following installation steps are performed by this script:</p>
<ol class="arabic simple">
<li><p>XRT Installation. The <a class="reference external" href="https://github.com/Xilinx/XRT">Xilinx RunTime (XRT)</a> is a combination of userspace and kernel driver components supporting PCIe accelerator cards such as the V70.</p></li>
<li><p>XRM Installation. The <a class="reference external" href="https://github.com/Xilinx/XRM/">Xilinx Resource Manager (XRM)</a> manages and controls FPGA resources on the host. It is required by the runtime.</p></li>
<li><p>Installation of the V70 platform.</p></li>
<li><p>Installation of the DPU xclbin for the V70 platform.</p></li>
</ol>
<p>After the script is executed successfully, use the XRT <cite>xbutil</cite> command to check that the installation was successful. The result should contain the correct information for System Configuration, XRT and Devices present.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">xilinx</span><span class="o">/</span><span class="n">xrt</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">xbutil</span> <span class="n">examine</span>
</pre></div>
</div>
</section>
</section>
<section id="clone-the-vitis-ai-repository">
<h3>Clone the Vitis AI Repository<a class="headerlink" href="#clone-the-vitis-ai-repository" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/Xilinx/Vitis-AI
<span class="nb">cd</span> Vitis-AI
</pre></div>
</div>
</div></blockquote>
</section>
<section id="install-docker">
<h3>Install Docker<a class="headerlink" href="#install-docker" title="Permalink to this heading">¶</a></h3>
<p>Make sure that the Docker engine is installed according to the official Docker <a class="reference external" href="https://docs.docker.com/engine/install/">documentation</a>.</p>
<p>The Docker daemon always runs as the root user. Non-root users must be <a class="reference external" href="https://docs.docker.com/engine/install/linux-postinstall/">added</a> to the docker group. Do this now.</p>
<p>Perform a quick and simple test of your Docker installation by executing the following command.  This command will download a test image from Docker Hub and run it in a container. When the container runs successfully, it prints a “Hello World” message and exits.</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>docker run hello-world
</pre></div>
</div>
</div></blockquote>
<p>Finally, verify that the version of Docker that you have installed meets the minimum <a class="reference internal" href="../reference/system_requirements.html"><span class="doc">Host System Requirements</span></a> by running the following command</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>docker --version
</pre></div>
</div>
</div></blockquote>
</section>
<section id="pull-vitis-ai-docker">
<h3>Pull Vitis AI Docker<a class="headerlink" href="#pull-vitis-ai-docker" title="Permalink to this heading">¶</a></h3>
<p>For this quickstart tutorial we will simply use the CPU Docker.  It is generic, does not require the user to build the container, and has no specific GPU enablement requirements.  More advanced users can optionally skip this step and jump to the <a class="reference internal" href="../install/install.html"><span class="doc">Full Install Instructions</span></a> but we would recommend that new users start with this simpler first step.</p>
<p>Pull and start the latest Vitis AI Docker using the following commands:</p>
<blockquote>
<div><div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>docker pull xilinx/vitis-ai-pytorch-cpu:latest
./docker_run.sh xilinx/vitis-ai-pytorch-cpu:latest
</pre></div>
</div>
</div></blockquote>
<section id="docker-container-environment-variable-setup">
<h4>Docker Container Environment Variable Setup<a class="headerlink" href="#docker-container-environment-variable-setup" title="Permalink to this heading">¶</a></h4>
<p>First, ensure that you have cloned Vitis AI, entered the Vitis AI directory.  Start Docker.</p>
<p>From inside the docker container, execute one of the following commands to set the required environment variables for the DPU.  Note that the chosen xclbin file must be in the <code class="docutils literal notranslate"><span class="pre">/opt/xilinx/overlaybins</span></code> directory prior to execution. Select the xclbin that matches your chosen DPU configuration.</p>
<ul>
<li><p>For the Versal V70:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">&lt;</span><span class="n">Vitis</span><span class="o">-</span><span class="n">AI</span> <span class="n">install</span> <span class="n">path</span><span class="o">&gt;/</span><span class="n">board_setup</span><span class="o">/</span><span class="n">v70</span><span class="o">/</span><span class="n">setup</span><span class="o">.</span><span class="n">sh</span> <span class="n">DPUCV2DX8G_v70</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
</section>
<section id="run-the-vitis-ai-examples">
<h3>Run the Vitis AI Examples<a class="headerlink" href="#run-the-vitis-ai-examples" title="Permalink to this heading">¶</a></h3>
<p>In the docker system, <code class="docutils literal notranslate"><span class="pre">/workspace/examples/vai_runtime/</span></code> is the path for the following example. If you encounter any path errors in running examples, check to see if you follow the steps above to set the host. Then, follow the steps below to download the model and run the sample, take <code class="docutils literal notranslate"><span class="pre">resnet50</span></code> as an example.</p>
<ol class="arabic simple">
<li><p>Download the <a class="reference external" href="https://www.xilinx.com/bin/public/openDownload?filename=vitis_ai_runtime_r3.5.0_image_video.tar.gz">vitis_ai_runtime_r3.5.0_image_video.tar.gz</a> package and unzip it:</p></li>
</ol>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /workspace/examples
wget https://www.xilinx.com/bin/public/openDownload?filename<span class="o">=</span>vitis_ai_runtime_r3.0.0_image_video.tar.gz -O vitis_ai_runtime_r3.0.0_image_video.tar.gz
tar -xzvf vitis_ai_runtime_r3.0.0_image_video.tar.gz -C vai_runtime
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Download the <code class="docutils literal notranslate"><span class="pre">resnet50</span></code> model.</p></li>
</ol>
<ul class="simple">
<li><p>If the <code class="docutils literal notranslate"><span class="pre">/usr/share/vitis_ai_library/models</span></code> folder does not exist, create it first.</p></li>
</ul>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>sudo mkdir /usr/share/vitis_ai_library/models
</pre></div>
</div>
<ul class="simple">
<li><p>For V70 DPU IP, install the model package as follows.</p></li>
</ul>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>wget https://www.xilinx.com/bin/public/openDownload?filename<span class="o">=</span>resnet50-v70-DPUCV2DX8G-r3.5.0.tar.gz -O resnet50-v70-DPUCV2DX8G-r3.5.0.tar.gz
tar -xzvf resnet50-v70-DPUCV2DX8G-r3.5.0.tar.gz
sudo cp resnet50 /usr/share/vitis_ai_library/models -r
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Navigate to the example directory in docker container.</p></li>
</ol>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/Vitis-AI/examples/vai_runtime/resnet50
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Compile the example.</p></li>
</ol>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>bash -x build.sh
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Run the example.</p></li>
</ol>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>./resnet50 /usr/share/vitis_ai_library/models/resnet50/resnet50.xmodel
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Different DPU IP correspond to different model files, which cannot be used alternately.</p>
</div>
<p>For the examples with video input, only <code class="docutils literal notranslate"><span class="pre">webm</span></code> and <code class="docutils literal notranslate"><span class="pre">raw</span></code> format are supported by default with the official system image. If you want to support video data in other formats, you need to install the relevant packages on the system.</p>
</section>
<section id="quantize-compile-deploy-a-model">
<h3>Quantize, Compile, Deploy a Model<a class="headerlink" href="#quantize-compile-deploy-a-model" title="Permalink to this heading">¶</a></h3>
<p><em>Oops….the below is written for TF1.1 but needs to be updated to PyTorch so that it aligns with pulling the pre-built PyTorch CPU container as done above.  Aidan, can you build this out further?</em></p>
<p>This tutorial assumes that Vitis AI has been installed and that the MPSoC target has been configured, as explained in the installation instructions above.</p>
<ol class="arabic">
<li><p>Download the calibration images (the full dataset is from <a class="reference external" href="http://image-net.org/download-images">ImageNet</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>wget https://www.xilinx.com/bin/public/openDownload?filename=Imagenet_calib.tar.gz -O Imagenet_calib.tar.gz
tar -xzvf Imagenet_calib.tar.gz -C tf_resnetv1_50_imagenet_224_224_6.97G_3.0/data
</pre></div>
</div>
</li>
<li><p>Download the sample images used by the example application:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd /workspace/examples
wget https://www.xilinx.com/bin/public/openDownload?filename=vitis_ai_runtime_r3.0.0_image_video.tar.gz -O vitis_ai_runtime_r3.0.0_image_video.tar.gz
tar -xzvf vitis_ai_runtime_r3.0.0_image_video.tar.gz -C vai_runtime
</pre></div>
</div>
</li>
<li><p>Activate the Conda “vitis-ai-tensorflow” environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">vitis</span><span class="o">-</span><span class="n">ai</span><span class="o">-</span><span class="n">tensorflow</span>
</pre></div>
</div>
</li>
<li><p>Configure the quantization process: edit the <code class="docutils literal notranslate"><span class="pre">/workspace/tf_resnetv1_50_imagenet_224_224_6.97G_3.0/code/quantize/config.ini</span></code> file and set the <code class="docutils literal notranslate"><span class="pre">CALIB_BATCH_SIZE</span></code> option to <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p></li>
<li><p>Quantize the floating-point model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">workspace</span><span class="o">/</span><span class="n">tf_resnetv1_50_imagenet_224_224_6</span><span class="mf">.97</span><span class="n">G_3</span><span class="mf">.0</span><span class="o">/</span><span class="n">code</span><span class="o">/</span><span class="n">quantize</span>
<span class="n">bash</span> <span class="n">quantize</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</li>
<li><p>Compile the quantized model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">workspace</span><span class="o">/</span><span class="n">tf_resnetv1_50_imagenet_224_224_6</span><span class="mf">.97</span><span class="n">G_3</span><span class="mf">.0</span>
<span class="n">vai_c_tensorflow</span> <span class="o">-</span><span class="n">f</span> <span class="o">./</span><span class="n">quantized</span><span class="o">/</span><span class="n">quantize_eval_model</span><span class="o">.</span><span class="n">pb</span> <span class="o">-</span><span class="n">a</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">vitis_ai</span><span class="o">/</span><span class="n">compiler</span><span class="o">/</span><span class="n">arch</span><span class="o">/</span><span class="n">DPUCVDX8H</span><span class="o">/</span><span class="n">VCK50008PE</span><span class="o">/</span><span class="n">arch</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="o">./</span><span class="n">compiled</span> <span class="o">-</span><span class="n">n</span> <span class="n">resnet50_tf</span>
</pre></div>
</div>
</li>
<li><p>Cross-compile the example application (<em>details to be added</em>)
Note: the example is already pre-compiled in the standard board image, but I feel it is important to show the cross-compilation steps as this is something people will have to do routinely.</p></li>
<li><p>Transfer compiled example to MPSoC board (<em>details to be added</em>)</p></li>
<li><p>Execute example (<em>details to be added</em>)</p></li>
</ol>
</section>
<section id="working-with-the-vitis-ai-library">
<h3>Working with the Vitis AI Library<a class="headerlink" href="#working-with-the-vitis-ai-library" title="Permalink to this heading">¶</a></h3>
<p>Suppose you have downloaded <code class="docutils literal notranslate"><span class="pre">Vitis-AI</span></code>, entered <code class="docutils literal notranslate"><span class="pre">Vitis-AI</span></code> directory, and then started Docker image. Thus, <code class="docutils literal notranslate"><span class="pre">vai_libray</span></code> examples are located in the path of <code class="docutils literal notranslate"><span class="pre">/workspace/examples/vai_library/</span></code> in the docker system. To run an example for the Versal V70 card, use these steps:</p>
<ol class="arabic">
<li><dl>
<dt>Select the model for your platforms.</dt><dd><p>For each model, there will be a yaml file which is used for describe all the details about the model. In the yaml file, you will find the model’s download links for different platforms. Please choose the corresponding model and download it. Click [Xilinx AI Model Zoo](<a class="reference external" href="https://github.com/Xilinx/Vitis-AI/tree/master/model_zoo/model-list">https://github.com/Xilinx/Vitis-AI/tree/master/model_zoo/model-list</a>) to view all the models. Take [pytorch resnet50 yaml file](<a class="reference external" href="https://github.com/Xilinx/Vitis-AI/blob/master/model_zoo/model-list/pt_resnet50_imagenet_224_224_8.2G_3.5/model.yaml">https://github.com/Xilinx/Vitis-AI/blob/master/model_zoo/model-list/pt_resnet50_imagenet_224_224_8.2G_3.5/model.yaml</a>) as an example.</p>
<ul>
<li><p>If the <cite>/usr/share/vitis_ai_library/models</cite> folder does not exist, create it first:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">vitis_ai_library</span><span class="o">/</span><span class="n">models</span>
</pre></div>
</div>
</li>
<li><p>For DPUCV2DX8G DPU IP of V70 card, install the model package as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>wget https://www.xilinx.com/bin/public/openDownload?filename=resnet50_pt-v70-DPUCV2DX8G-r3.5.0.tar.gz -O resnet50_pt-v70-DPUCV2DX8G-r3.5.0.tar.gz
tar -xzvf resnet50-pt-v70-DPUCV2DX8G-r3.5.0.tar.gz
sudo cp resnet50_pt /usr/share/vitis_ai_library/models -r
</pre></div>
</div>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Download the [vitis_ai_library_r3.5.0_images.tar.gz](<a class="reference external" href="https://www.xilinx.com/bin/public/openDownload?filename=vitis_ai_library_r3.5.0_images.tar.gz">https://www.xilinx.com/bin/public/openDownload?filename=vitis_ai_library_r3.5.0_images.tar.gz</a>) and [vitis_ai_library_r3.5.0_video.tar.gz](<a class="reference external" href="https://www.xilinx.com/bin/public/openDownload?filename=vitis_ai_library_r3.5.0_video.tar.gz">https://www.xilinx.com/bin/public/openDownload?filename=vitis_ai_library_r3.5.0_video.tar.gz</a>) packages and untar them::</dt><dd><p>cd /workspace
wget <a class="reference external" href="https://www.xilinx.com/bin/public/openDownload?filename=vitis_ai_library_r3.5.0_images.tar.gz">https://www.xilinx.com/bin/public/openDownload?filename=vitis_ai_library_r3.5.0_images.tar.gz</a> -O vitis_ai_library_r3.5.0_images.tar.gz
wget <a class="reference external" href="https://www.xilinx.com/bin/public/openDownload?filename=vitis_ai_library_r3.5.0_video.tar.gz">https://www.xilinx.com/bin/public/openDownload?filename=vitis_ai_library_r3.5.0_video.tar.gz</a> -O vitis_ai_library_r3.5.0_video.tar.gz
tar -xzvf vitis_ai_library_r3.5.0_images.tar.gz -C examples/vai_library/
tar -xzvf vitis_ai_library_r3.5.0_video.tar.gz -C examples/vai_library/</p>
</dd>
</dl>
</li>
<li><p>Enter the directory of the sample and then compile it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">workspace</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">vai_library</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">classification</span>
<span class="n">bash</span> <span class="o">-</span><span class="n">x</span> <span class="n">build</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</li>
<li><p>Run the image test mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">test_jpeg_classification</span> <span class="n">resnet50_pt</span> <span class="n">sample_classification</span><span class="o">.</span><span class="n">jpg</span>
</pre></div>
</div>
</li>
<li><p>To run the video example, run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">test_video_classification</span> <span class="n">resnet50_pt</span> <span class="o">&lt;</span><span class="n">video_input</span><span class="o">.</span><span class="n">mp4</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">t</span> <span class="mi">8</span>
</pre></div>
</div>
</li>
</ol>
<p>Here, video_input.mp4 is the video file that you have to prepare for input and -t is the
number of threads.</p>
<ol class="arabic" start="6">
<li><p>To test the performance of the model, run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">test_performance_classification</span> <span class="n">resnet50_pt</span>
<span class="n">test_performance_classification</span><span class="o">.</span><span class="n">list</span> <span class="o">-</span><span class="n">t</span> <span class="mi">8</span> <span class="o">-</span><span class="n">s</span> <span class="mi">60</span>
</pre></div>
</div>
</li>
</ol>
<p>Here, -t is the number of threads and -s is the number of seconds. To view a complete listing of command line options for the executable, run the command with the ‘-h’ switch.</p>
<p>Note: The performance test program is automatically run in batch mode</p>
</section>
</section>
</section>


           </div>
          </div>
          
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vek280.html" class="btn btn-neutral float-left" title="Quick Start Guide for Versal™ AI Edge VEK280" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="custom_target.html" class="btn btn-neutral float-right" title="Custom Board to Do" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2023, Advanced Micro Devices, Inc.
      <span class="lastupdated">Last updated on June 29, 2023.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>